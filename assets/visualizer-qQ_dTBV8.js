import{j as s,r as fe}from"./index-D6mgrPXT.js";/**!
 * audioMotion-analyzer
 * High-resolution real-time graphic audio spectrum analyzer JS module
 *
 * @version 4.5.0
 * @author  Henrique Avila Vianna <hvianna@gmail.com> <https://henriquevianna.com>
 * @license AGPL-3.0-or-later
 */const Wt="4.5.0",ut=Math.PI,Ie=2*ut,lt=ut/2,xt=8.17579892,vt="dual-combined",$e="dual-horizontal",ye="single",Le="dual-vertical",wt="bar-index",bt="bar-level",Ze="gradient",Lt=60,Rt="click",Xt="fullscreenchange",Ot="resize",Ut="#111",It="",yt="A",St="B",Ct="C",At="D",Et="468",Ke="sans-serif",Yt="#0f0",$t="#7f7f7f22",He=10,Bt="create",Nt="fschange",Kt="lores",Qt=Ot,ot="user",Zt="#000c",kt="#fff",Jt="#4f4",Tt="#888",ei="#555",ht="bark",Ve="linear",De="log",ct="mel",Mt=["#a35","#c66","#e94","#ed0","#9d5","#4d8","#2cb","#0bc","#09c","#36b"],Ht=[["classic",{colorStops:["red",{color:"yellow",level:.85,pos:.6},{color:"lime",level:.475}]}],["prism",{colorStops:Mt}],["rainbow",{dir:"h",colorStops:["#817",...Mt,"#639"]}],["orangered",{bgColor:"#3e2f29",colorStops:["OrangeRed"]}],["steelblue",{bgColor:"#222c35",colorStops:["SteelBlue"]}]],We={alphaBars:!1,ansiBands:!1,barSpace:.1,bgAlpha:.7,channelLayout:ye,colorMode:Ze,fadePeaks:!1,fftSize:8192,fillAlpha:1,frequencyScale:De,gradient:Ht[0][0],gravity:3.8,height:void 0,ledBars:!1,linearAmplitude:!1,linearBoost:1,lineWidth:0,loRes:!1,lumiBars:!1,maxDecibels:-25,maxFPS:0,maxFreq:22e3,minDecibels:-85,minFreq:20,mirror:0,mode:0,noteLabels:!1,outlineBars:!1,overlay:!1,peakFadeTime:750,peakHoldTime:500,peakLine:!1,radial:!1,radialInvert:!1,radius:.3,reflexAlpha:.15,reflexBright:1,reflexFit:!0,reflexRatio:0,roundBars:!1,showBgColor:!0,showFPS:!1,showPeaks:!0,showScaleX:!0,showScaleY:!1,smoothing:.5,spinSpeed:0,splitGradient:!1,start:!0,trueLeds:!1,useCanvas:!0,volume:1,weightingFilter:It,width:void 0},ti=["ERR_AUDIO_CONTEXT_FAIL","Could not create audio context. Web Audio API not supported?"],ii=["ERR_INVALID_AUDIO_CONTEXT","Provided audio context is not valid"],si=["ERR_UNKNOWN_GRADIENT","Unknown gradient"],dt=["ERR_FREQUENCY_TOO_LOW","Frequency values must be >= 1"],ai=["ERR_INVALID_MODE","Invalid mode"],ni=["ERR_REFLEX_OUT_OF_RANGE","Reflex ratio must be >= 0 and < 1"],ri=["ERR_INVALID_AUDIO_SOURCE","Audio source must be an instance of HTMLMediaElement or AudioNode"],li=["ERR_GRADIENT_INVALID_NAME","Gradient name must be a non-empty string"],oi=["ERR_GRADIENT_NOT_AN_OBJECT","Gradient options must be an object"],hi=["ERR_GRADIENT_MISSING_COLOR","Gradient colorStops must be a non-empty array"];class _e extends Error{constructor(e,i){const[a,r]=e;super(r+(i!==void 0?`: ${i}`:"")),this.name="AudioMotionError",this.code=a}}const jt=(x,e)=>console.warn(`${x} is deprecated. Use ${e} instead.`),zt=x=>{for(const e in x)return!1;return!0},Qe=(x,e,i="toLowerCase")=>e[Math.max(0,e.indexOf((""+x)[i]()))],ci=(x,e,i,a,r)=>e+(a-e)*(r-x)/(i-x);Array.prototype.findLastIndex||(Array.prototype.findLastIndex=function(x){let e=this.length;for(;e-- >0;)if(x(this[e]))return e;return-1});class di{constructor(e,i={}){this._ready=!1,this._aux={},this._canvasGradients=[],this._destroyed=!1,this._energy={val:0,peak:0,hold:0},this._flg={},this._fps=0,this._gradients={},this._last=0,this._outNodes=[],this._ownContext=!1,this._selectedGrads=[],this._sources=[],e instanceof Element||(zt(i)&&!zt(e)&&(i=e),e=null),this._ownCanvas=!(i.canvas instanceof HTMLCanvasElement);const a=this._ownCanvas?document.createElement("canvas"):i.canvas;a.style="max-width: 100%;",this._ctx=a.getContext("2d");for(const[f,B]of Ht)this.registerGradient(f,B);this._container=e||!this._ownCanvas&&a.parentElement||document.body,this._defaultWidth=this._container.clientWidth||640,this._defaultHeight=this._container.clientHeight||270;let r;if(!(i.source&&(r=i.source.context))){if(!(r=i.audioCtx))try{r=new(window.AudioContext||window.webkitAudioContext),this._ownContext=!0}catch{throw new _e(ti)}}if(!r.createGain)throw new _e(ii);const h=this._analyzer=[r.createAnalyser(),r.createAnalyser()],l=this._splitter=r.createChannelSplitter(2),o=this._merger=r.createChannelMerger(2);this._input=r.createGain(),this._output=r.createGain(),i.source&&this.connectInput(i.source);for(const f of[0,1])l.connect(h[f],f);o.connect(this._output),i.connectSpeakers!==!1&&this.connectOutput();for(const f of["_scaleX","_scaleR"])this[f]=document.createElement("canvas").getContext("2d");this._fsEl=i.fsElement||a;const u=()=>{this._fsTimeout||(this._fsTimeout=window.setTimeout(()=>{this._fsChanging||(this._setCanvas(Qt),this._fsTimeout=0)},Lt))};window.ResizeObserver&&(this._observer=new ResizeObserver(u),this._observer.observe(this._container)),this._controller=new AbortController;const R=this._controller.signal;window.addEventListener(Ot,u,{signal:R}),a.addEventListener(Xt,()=>{this._fsChanging=!0,this._fsTimeout&&window.clearTimeout(this._fsTimeout),this._setCanvas(Nt),this._fsTimeout=window.setTimeout(()=>{this._fsChanging=!1,this._fsTimeout=0},Lt)},{signal:R});const p=()=>{r.state=="suspended"&&r.resume(),window.removeEventListener(Rt,p)};window.addEventListener(Rt,p),document.addEventListener("visibilitychange",()=>{document.visibilityState!="hidden"&&(this._frames=0,this._time=performance.now())},{signal:R}),this._setProps(i,!0),this.useCanvas&&this._ownCanvas&&this._container.appendChild(a),this._ready=!0,this._setCanvas(Bt)}get alphaBars(){return this._alphaBars}set alphaBars(e){this._alphaBars=!!e,this._calcBars()}get ansiBands(){return this._ansiBands}set ansiBands(e){this._ansiBands=!!e,this._calcBars()}get barSpace(){return this._barSpace}set barSpace(e){this._barSpace=+e||0,this._calcBars()}get channelLayout(){return this._chLayout}set channelLayout(e){this._chLayout=Qe(e,[ye,$e,Le,vt]),this._input.disconnect(),this._input.connect(this._chLayout!=ye?this._splitter:this._analyzer[0]),this._analyzer[0].disconnect(),this._outNodes.length&&this._analyzer[0].connect(this._chLayout!=ye?this._merger:this._output),this._calcBars(),this._makeGrad()}get colorMode(){return this._colorMode}set colorMode(e){this._colorMode=Qe(e,[Ze,wt,bt])}get fadePeaks(){return this._fadePeaks}set fadePeaks(e){this._fadePeaks=!!e}get fftSize(){return this._analyzer[0].fftSize}set fftSize(e){for(const a of[0,1])this._analyzer[a].fftSize=e;const i=this._analyzer[0].frequencyBinCount;this._fftData=[new Float32Array(i),new Float32Array(i)],this._calcBars()}get frequencyScale(){return this._frequencyScale}set frequencyScale(e){this._frequencyScale=Qe(e,[De,ht,ct,Ve]),this._calcBars()}get gradient(){return this._selectedGrads[0]}set gradient(e){this._setGradient(e)}get gradientLeft(){return this._selectedGrads[0]}set gradientLeft(e){this._setGradient(e,0)}get gradientRight(){return this._selectedGrads[1]}set gradientRight(e){this._setGradient(e,1)}get gravity(){return this._gravity}set gravity(e){this._gravity=e>0?+e:this._gravity||We.gravity}get height(){return this._height}set height(e){this._height=e,this._setCanvas(ot)}get ledBars(){return this._showLeds}set ledBars(e){this._showLeds=!!e,this._calcBars()}get linearAmplitude(){return this._linearAmplitude}set linearAmplitude(e){this._linearAmplitude=!!e}get linearBoost(){return this._linearBoost}set linearBoost(e){this._linearBoost=e>=1?+e:1}get lineWidth(){return this._lineWidth}set lineWidth(e){this._lineWidth=+e||0}get loRes(){return this._loRes}set loRes(e){this._loRes=!!e,this._setCanvas(Kt)}get lumiBars(){return this._lumiBars}set lumiBars(e){this._lumiBars=!!e,this._calcBars(),this._makeGrad()}get maxDecibels(){return this._analyzer[0].maxDecibels}set maxDecibels(e){for(const i of[0,1])this._analyzer[i].maxDecibels=e}get maxFPS(){return this._maxFPS}set maxFPS(e){this._maxFPS=e<0?0:+e||0}get maxFreq(){return this._maxFreq}set maxFreq(e){if(e<1)throw new _e(dt);this._maxFreq=Math.min(e,this.audioCtx.sampleRate/2),this._calcBars()}get minDecibels(){return this._analyzer[0].minDecibels}set minDecibels(e){for(const i of[0,1])this._analyzer[i].minDecibels=e}get minFreq(){return this._minFreq}set minFreq(e){if(e<1)throw new _e(dt);this._minFreq=+e,this._calcBars()}get mirror(){return this._mirror}set mirror(e){this._mirror=Math.sign(e)|0,this._calcBars(),this._makeGrad()}get mode(){return this._mode}set mode(e){const i=e|0;if(i>=0&&i<=10&&i!=9)this._mode=i,this._calcBars(),this._makeGrad();else throw new _e(ai,e)}get noteLabels(){return this._noteLabels}set noteLabels(e){this._noteLabels=!!e,this._createScales()}get outlineBars(){return this._outlineBars}set outlineBars(e){this._outlineBars=!!e,this._calcBars()}get peakFadeTime(){return this._peakFadeTime}set peakFadeTime(e){this._peakFadeTime=e>=0?+e:this._peakFadeTime||We.peakFadeTime}get peakHoldTime(){return this._peakHoldTime}set peakHoldTime(e){this._peakHoldTime=+e||0}get peakLine(){return this._peakLine}set peakLine(e){this._peakLine=!!e}get radial(){return this._radial}set radial(e){this._radial=!!e,this._calcBars(),this._makeGrad()}get radialInvert(){return this._radialInvert}set radialInvert(e){this._radialInvert=!!e,this._calcBars(),this._makeGrad()}get radius(){return this._radius}set radius(e){this._radius=+e||0,this._calcBars(),this._makeGrad()}get reflexRatio(){return this._reflexRatio}set reflexRatio(e){if(e=+e||0,e<0||e>=1)throw new _e(ni);this._reflexRatio=e,this._calcBars(),this._makeGrad()}get roundBars(){return this._roundBars}set roundBars(e){this._roundBars=!!e,this._calcBars()}get smoothing(){return this._analyzer[0].smoothingTimeConstant}set smoothing(e){for(const i of[0,1])this._analyzer[i].smoothingTimeConstant=e}get spinSpeed(){return this._spinSpeed}set spinSpeed(e){e=+e||0,(this._spinSpeed===void 0||e==0)&&(this._spinAngle=-lt),this._spinSpeed=e}get splitGradient(){return this._splitGradient}set splitGradient(e){this._splitGradient=!!e,this._makeGrad()}get stereo(){return jt("stereo","channelLayout"),this._chLayout!=ye}set stereo(e){jt("stereo","channelLayout"),this.channelLayout=e?Le:ye}get trueLeds(){return this._trueLeds}set trueLeds(e){this._trueLeds=!!e}get volume(){return this._output.gain.value}set volume(e){this._output.gain.value=e}get weightingFilter(){return this._weightingFilter}set weightingFilter(e){this._weightingFilter=Qe(e,[It,yt,St,Ct,At,Et],"toUpperCase")}get width(){return this._width}set width(e){this._width=e,this._setCanvas(ot)}get audioCtx(){return this._input.context}get canvas(){return this._ctx.canvas}get canvasCtx(){return this._ctx}get connectedSources(){return this._sources}get connectedTo(){return this._outNodes}get fps(){return this._fps}get fsHeight(){return this._fsHeight}get fsWidth(){return this._fsWidth}get isAlphaBars(){return this._flg.isAlpha}get isBandsMode(){return this._flg.isBands}get isDestroyed(){return this._destroyed}get isFullscreen(){return this._fsEl&&(document.fullscreenElement||document.webkitFullscreenElement)===this._fsEl}get isLedBars(){return this._flg.isLeds}get isLumiBars(){return this._flg.isLumi}get isOctaveBands(){return this._flg.isOctaves}get isOn(){return!!this._runId}get isOutlineBars(){return this._flg.isOutline}get pixelRatio(){return this._pixelRatio}get isRoundBars(){return this._flg.isRound}static get version(){return Wt}connectInput(e){const i=e instanceof HTMLMediaElement;if(!(i||e.connect))throw new _e(ri);const a=i?this.audioCtx.createMediaElementSource(e):e;return this._sources.includes(a)||(a.connect(this._input),this._sources.push(a)),a}connectOutput(e=this.audioCtx.destination){if(!this._outNodes.includes(e)&&(this._output.connect(e),this._outNodes.push(e),this._outNodes.length==1))for(const i of[0,1])this._analyzer[i].connect(this._chLayout==ye&&!i?this._output:this._merger,0,i)}destroy(){if(!this._ready)return;const{audioCtx:e,canvas:i,_controller:a,_input:r,_merger:h,_observer:l,_ownCanvas:o,_ownContext:u,_splitter:R}=this;this._destroyed=!0,this._ready=!1,this.stop(),a.abort(),l&&l.disconnect(),this.onCanvasResize=null,this.onCanvasDraw=null,this._fsEl=null,this.disconnectInput(),this.disconnectOutput(),r.disconnect(),R.disconnect(),h.disconnect(),u&&e.close(),o&&i.remove(),this._calcBars()}disconnectInput(e,i){e?Array.isArray(e)||(e=[e]):e=Array.from(this._sources);for(const a of e){const r=this._sources.indexOf(a);if(i&&a.mediaStream)for(const h of a.mediaStream.getAudioTracks())h.stop();r>=0&&(a.disconnect(this._input),this._sources.splice(r,1))}}disconnectOutput(e){if(!(e&&!this._outNodes.includes(e))&&(this._output.disconnect(e),this._outNodes=e?this._outNodes.filter(i=>i!==e):[],this._outNodes.length==0))for(const i of[0,1])this._analyzer[i].disconnect()}getBars(){return Array.from(this._bars,({posX:e,freq:i,freqLo:a,freqHi:r,hold:h,peak:l,value:o})=>({posX:e,freq:i,freqLo:a,freqHi:r,hold:h,peak:l,value:o}))}getEnergy(e,i){if(e===void 0)return this._energy.val;if(e!=+e){if(e=="peak")return this._energy.peak;const o={bass:[20,250],lowMid:[250,500],mid:[500,2e3],highMid:[2e3,4e3],treble:[4e3,16e3]};if(!o[e])return null;[e,i]=o[e]}const a=this._freqToBin(e),r=i?this._freqToBin(i):a,h=this._chLayout==ye?1:2;let l=0;for(let o=0;o<h;o++)for(let u=a;u<=r;u++)l+=this._normalizedB(this._fftData[o][u]);return l/(r-a+1)/h}getOptions(e){Array.isArray(e)||(e=[e]);let i={};for(const a of Object.keys(We))e.includes(a)||(a=="gradient"&&this.gradientLeft!=this.gradientRight?(i.gradientLeft=this.gradientLeft,i.gradientRight=this.gradientRight):a!="start"&&(i[a]=this[a]));return i}registerGradient(e,i){if(typeof e!="string"||e.trim().length==0)throw new _e(li);if(typeof i!="object")throw new _e(oi);const{colorStops:a}=i;if(!Array.isArray(a)||!a.length)throw new _e(hi);const r=a.length,h=l=>+l!=l||l<0||l>1;a.forEach((l,o)=>{const u=o/Math.max(1,r-1);typeof l!="object"?a[o]={pos:u,color:l}:h(l.pos)&&(l.pos=u),h(l.level)&&(a[o].level=1-o/r)}),a.sort((l,o)=>l.level<o.level?1:l.level>o.level?-1:0),a[0].level=1,this._gradients[e]={bgColor:i.bgColor||Ut,dir:i.dir,colorStops:a},this._selectedGrads.includes(e)&&this._makeGrad()}setCanvasSize(e,i){this._width=e,this._height=i,this._setCanvas(ot)}setFreqRange(e,i){if(e<1||i<1)throw new _e(dt);this._minFreq=Math.min(e,i),this.maxFreq=Math.max(e,i)}setLedParams(e){let i,a,r;e&&(i=e.maxLeds|0,a=+e.spaceV,r=+e.spaceH),this._ledParams=i>0&&a>0&&r>=0?[i,a,r]:void 0,this._calcBars()}setOptions(e){this._setProps(e)}setSensitivity(e,i){for(const a of[0,1])this._analyzer[a].minDecibels=Math.min(e,i),this._analyzer[a].maxDecibels=Math.max(e,i)}start(){this.toggleAnalyzer(!0)}stop(){this.toggleAnalyzer(!1)}toggleAnalyzer(e){const i=this.isOn;return e===void 0&&(e=!i),i&&!e?(cancelAnimationFrame(this._runId),this._runId=0):!i&&e&&!this._destroyed&&(this._frames=0,this._time=performance.now(),this._runId=requestAnimationFrame(a=>this._draw(a))),this.isOn}toggleFullscreen(){if(this.isFullscreen)document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen();else{const e=this._fsEl;if(!e)return;e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()}}_binToFreq(e){return e*this.audioCtx.sampleRate/this.fftSize||1}_calcBars(){const e=this._bars=[];if(!this._ready){this._flg={isAlpha:!1,isBands:!1,isLeds:!1,isLumi:!1,isOctaves:!1,isOutline:!1,isRound:!1,noLedGap:!1};return}const{_ansiBands:i,_barSpace:a,canvas:r,_chLayout:h,_maxFreq:l,_minFreq:o,_mirror:u,_mode:R,_radial:p,_radialInvert:f,_reflexRatio:B}=this,X=r.width>>1,U=r.height>>1,C=h==Le&&!p,H=h==$e,A=R%10!=0,se=A&&this._frequencyScale==De,v=this._showLeds&&A&&!p,D=this._lumiBars&&A&&!p,ae=this._alphaBars&&!D&&R!=He,J=this._outlineBars&&A&&!D&&!v,w=this._roundBars&&A&&!D&&!v,Q=h!=Le||B>0&&!D,P=r.height-(C&&!v?.5:0)>>C,d=P*(D||p?1:1-B)|0,t=r.width-X*(H||u!=0),F=C?r.height-P*2:0,ne=X*(u==-1&&!H&&!p);let te=Math.min(r.width,r.height)*.375*(h==Le?1:this._radius)|0,j=Math.min(X,U);f&&h!=Le&&([te,j]=[j,te]);const k=T=>e.push({...T,peak:[0,0],hold:[0],alpha:[0],value:[0]}),y=T=>{const O=this._freqToBin(T,"floor"),b=this._binToFreq(O),S=this._binToFreq(O+1),q=Math.log2(T/b)/Math.log2(S/b);return[O,q]};let g,Y,z;if(se){const T=(M,W,N)=>+M.toPrecision(N?Math.max(W,1+Math.log10(M)|0):W),O=M=>{const W=[1,1.12,1.25,1.4,1.6,1.8,2,2.24,2.5,2.8,3.15,3.55,4,4.5,5,5.6,6.3,7.1,8,9,10],N=Math.log10(M)|0,xe=M/10**N;let ge=1;for(;ge<W.length&&xe>W[ge];)ge++;return xe-W[ge-1]<W[ge]-xe&&ge--,(W[ge]*10**(N+5)|0)/1e5},b=[0,24,12,8,6,4,3,2,1][R],S=i?10**(3/(b*10)):2**(1/b),q=S**.5;let re=i?7.94328235/(b%2?1:q):xt;do{let M=re;const W=T(M/q,4,!0),N=T(M*q,4,!0),[xe,ge]=y(W),[Fe,ve]=y(N);i?M=b<4?O(M):T(M,M.toString()[0]<5?3:2):M=T(M,4,!0),M>=o&&k({posX:0,freq:M,freqLo:W,freqHi:N,binLo:xe,binHi:Fe,ratioLo:ge,ratioHi:ve}),re*=S}while(re<=l);g=t/e.length,e.forEach((M,W)=>M.posX=ne+W*g);const V=e[0],ie=e[e.length-1];Y=this._freqScaling(V.freqLo),z=t/(this._freqScaling(ie.freqHi)-Y),V.freqLo<o&&(V.freqLo=o,[V.binLo,V.ratioLo]=y(o)),ie.freqHi>l&&(ie.freqHi=l,[ie.binHi,ie.ratioHi]=y(l))}else if(A){const T=[0,24,12,8,6,4,3,2,1][R]*10,O=b=>{switch(this._frequencyScale){case ht:return 1960/(26.81/(b+.53)-1);case ct:return 700*(2**b-1);case Ve:return b}};g=t/T,Y=this._freqScaling(o),z=t/(this._freqScaling(l)-Y);for(let b=0,S=0;b<T;b++,S+=g){const q=O(Y+S/z),re=O(Y+(S+g/2)/z),V=O(Y+(S+g)/z),[ie,M]=y(q),[W,N]=y(V);k({posX:ne+S,freq:re,freqLo:q,freqHi:V,binLo:ie,binHi:W,ratioLo:M,ratioHi:N})}}else{g=1,Y=this._freqScaling(o),z=t/(this._freqScaling(l)-Y);const T=this._freqToBin(o,"floor"),O=this._freqToBin(l);let b=-999;for(let S=T;S<=O;S++){const q=this._binToFreq(S),re=ne+Math.round(z*(this._freqScaling(q)-Y));if(re>b)k({posX:re,freq:q,freqLo:q,freqHi:q,binLo:S,binHi:S,ratioLo:0,ratioHi:0}),b=re;else if(e.length){const V=e[e.length-1];V.binHi=S,V.freqHi=q,V.freq=(V.freqLo*q)**.5}}}let oe=0,K=0;if(v){const T=this._pixelRatio/(window.devicePixelRatio>1&&window.screen.height<=540?2:1),O=[[],[128,3,.45],[128,4,.225],[96,6,.225],[80,6,.225],[80,6,.125],[64,6,.125],[48,8,.125],[24,16,.125]],b=this._ledParams,[S,q,re]=b||O[R];let V,ie=d;if(b){const M=2*T;let W;V=S+1;do V--,W=ie/V/(1+q),K=W*q;while((W<M||K<M)&&V>1)}else{const M=540/q;K=Math.min(q*T,Math.max(2,ie/M+.1|0))}Q&&(ie+=K),b||(V=Math.min(S,ie/(K*2)|0)),oe=re>=1?re:g*re,this._leds=[V,oe,K,ie/V-K]}const E=Math.min(g-1,a*(a>0&&a<1?g:1));A&&(g-=Math.max(v?oe:0,E)),e.forEach((T,O)=>{let b=T.posX,S=g;A&&(a==0&&!v?(b|=0,S|=0,O>0&&b>e[O-1].posX+e[O-1].width&&(b--,S++)):b+=Math.max(v?oe:0,E)/2,T.posX=b),T.barCenter=b+(g==1?0:S/2),T.width=S});const me=[];for(const T of[0,1]){const O=h==Le?(P+F)*T:0,b=O+P,S=O+d-(!v||Q?0:K);me.push({channelTop:O,channelBottom:b,analyzerBottom:S})}this._aux={analyzerHeight:d,analyzerWidth:t,centerX:X,centerY:U,channelCoords:me,channelHeight:P,channelGap:F,initialX:ne,innerRadius:te,outerRadius:j,scaleMin:Y,unitWidth:z},this._flg={isAlpha:ae,isBands:A,isLeds:v,isLumi:D,isOctaves:se,isOutline:J,isRound:w,noLedGap:Q},this._createScales()}_createScales(){if(!this._ready)return;const{analyzerWidth:e,initialX:i,innerRadius:a,scaleMin:r,unitWidth:h}=this._aux,{canvas:l,_frequencyScale:o,_mirror:u,_noteLabels:R,_radial:p,_scaleX:f,_scaleR:B}=this,X=f.canvas,U=B.canvas,C=[],H=this._chLayout==$e,A=this._chLayout==Le,se=Math.min(l.width,l.height),v=["C",,"D",,"E","F",,"G",,"A",,"B"],D=se/34|0,ae=X.height>>1,J=D>>1,w=ae*(R?.7:1.5),Q=J*(R?1:2),P=2**(1/12);if(!R&&(this._ansiBands||o!=De))C.push(16,31.5,63,125,250,500,1e3,2e3,4e3),o==Ve?C.push(6e3,8e3,1e4,12e3,14e3,16e3,18e3,2e4,22e3):C.push(8e3,16e3);else{let j=xt;for(let k=-1;k<11;k++)for(let y=0;y<12;y++){if(j>=this._minFreq&&j<=this._maxFreq){const g=v[y],Y=g=="C";(g&&R&&!u&&!H||Y)&&C.push(R?[j,g+(Y?k:"")]:j)}j*=P}}U.width=U.height=Math.max(se*.15,(a<<1)+A*D);const d=U.width>>1,t=d-D*.7,F=(j,k)=>{const y=Ie*(j/l.width),g=y-lt,Y=t*Math.cos(g),z=t*Math.sin(g);B.save(),B.translate(d+Y,d+z),B.rotate(y),B.fillText(k,0,0),B.restore()};X.width|=0,f.fillStyle=B.strokeStyle=Zt,f.fillRect(0,0,X.width,X.height),B.arc(d,d,d-D/2,0,Ie),B.lineWidth=D,B.stroke(),f.fillStyle=B.fillStyle=kt,f.font=`${ae}px ${Ke}`,B.font=`${J}px ${Ke}`,f.textAlign=B.textAlign="center";let ne=-w/4,te=-Q;for(const j of C){const[k,y]=Array.isArray(j)?j:[j,j<1e3?j|0:`${(j/100|0)/10}k`],g=h*(this._freqScaling(k)-r),Y=X.height*.75,z=y[0]=="C",oe=ae*(R&&!u&&!H?z?1.2:.6:3);if(f.fillStyle=B.fillStyle=z&&!u&&!H?Jt:kt,R){const K=o==De,E=o==Ve;let me=["C"];if((K||k>2e3||!E&&k>250||(!p||A)&&(!E&&k>125||k>1e3))&&me.push("G"),(K||k>4e3||!E&&k>500||(!p||A)&&(!E&&k>250||k>2e3))&&me.push("E"),(E&&k>4e3||(!p||A)&&(K||k>2e3||!E&&k>500))&&me.push("D","F","A","B"),!me.includes(y[0]))continue}g>=ne+w/2&&g<=e&&(f.fillText(y,H&&u==-1?e-g:i+g,Y,oe),(H||u&&(g>w||u==1))&&f.fillText(y,H&&u!=1?e+g:(i||l.width)-g,Y,oe),ne=g+Math.min(oe,f.measureText(y).width)/2),g>=te+Q&&g<e-Q&&(F(H&&u==1?e-g:g,y),(H||u&&(g>Q||u==1))&&F(H&&u!=-1?e+g:-g,y),te=g)}}_draw(e){this._runId=requestAnimationFrame(n=>this._draw(n));const i=e-this._time,a=e-this._last,r=this._maxFPS?975/this._maxFPS:0;if(a<r)return;this._last=e-(r?a%r:0),this._frames++,i>=1e3&&(this._fps=this._frames/i*1e3,this._frames=0,this._time=e);const{isAlpha:h,isBands:l,isLeds:o,isLumi:u,isOctaves:R,isOutline:p,isRound:f,noLedGap:B}=this._flg,{analyzerHeight:X,centerX:U,centerY:C,channelCoords:H,channelHeight:A,channelGap:se,initialX:v,innerRadius:D,outerRadius:ae}=this._aux,{_bars:J,canvas:w,_canvasGradients:Q,_chLayout:P,_colorMode:d,_ctx:t,_energy:F,_fadePeaks:ne,fillAlpha:te,_fps:j,_linearAmplitude:k,_lineWidth:y,maxDecibels:g,minDecibels:Y,_mirror:z,_mode:oe,overlay:K,_radial:E,showBgColor:me,showPeaks:T,useCanvas:O,_weightingFilter:b}=this,S=this._scaleX.canvas,q=this._scaleR.canvas,re=j*this._peakFadeTime/1e3,V=j**2,ie=this._gravity*1e3,M=j*this._peakHoldTime/1e3,W=P==vt,N=P==$e,xe=P==Le,ge=P==ye,Fe=o&&this._trueLeds&&d==Ze,ve=E?w.width:this._aux.analyzerWidth,Je=v+ve,Ge=T&&this._peakLine&&oe==He,Se=E?ae-D:X,Dt=Se/this._pixelRatio,[Ft,Ri,Pe,et]=this._leds||[];F.val>0&&j>0&&(this._spinAngle+=this._spinSpeed*Ie/60/j);const Gt=n=>{if(this._reflexRatio>0&&!u&&!E){let L,we;this.reflexFit||xe?(L=xe&&n==0?A+se:0,we=A-X):(L=w.height-X*2,we=X),t.save(),t.globalAlpha=this.reflexAlpha,this.reflexBright!=1&&(t.filter=`brightness(${this.reflexBright})`),t.setTransform(1,0,0,-1,0,w.height),t.drawImage(w,0,H[n].channelTop,w.width,X,0,L,w.width,we),t.restore()}},Pt=()=>{this.showScaleX&&(E?(t.save(),t.translate(U,C),this._spinSpeed&&t.rotate(this._spinAngle+lt),t.drawImage(q,-q.width>>1,-q.width>>1),t.restore()):t.drawImage(S,0,w.height-S.height))},qt=n=>{const L=n**2,we=424.36,ee=11599.29,Xe=25122.25,Ce=544496.41,Re=148693636,Ne=ke=>20*Math.log10(ke);switch(b){case yt:const ke=Re*L**2/((L+we)*Math.sqrt((L+ee)*(L+Ce))*(L+Re));return 2+Ne(ke);case St:const Te=Re*L*n/((L+we)*Math.sqrt(L+Xe)*(L+Re));return .17+Ne(Te);case Ct:const st=Re*L/((L+we)*(L+Re));return .06+Ne(st);case At:const Ue=((103791848e-2-L)**2+108076816e-2*L)/((9837328-L)**2+11723776*L),at=n/68966888496476e-18*Math.sqrt(Ue/((L+79919.29)*(L+1345600)));return Ne(at);case Et:const Ye=-4737338981378384e-39*n**6+2043828333606125e-30*n**4-1363894795463638e-22*L+1,Me=1306612257412824e-34*n**5-2118150887518656e-26*n**3+.0005559488023498642*n,ce=.0001246332637532143*n/Math.hypot(Ye,Me);return 18.2+Ne(ce)}return 0},tt=(n,L,we)=>{t.beginPath(),t.moveTo(n,L),t.lineTo(n,we),t.stroke()},it=n=>{if(n&&y){const L=t.globalAlpha;t.globalAlpha=1,t.stroke(),t.globalAlpha=L}},Be=n=>Math.max(0,(n*Ft|0)*(et+Pe)-Pe),Vt=n=>{F.val=n,F.peak>0&&(F.hold--,F.hold<0&&(F.peak+=F.hold*ie/V/w.height*this._pixelRatio)),n>=F.peak&&(F.peak=n,F.hold=M)};K&&t.clearRect(0,0,w.width,w.height);let ft=0;const _t=J.length,mt=ge?1:2;for(let n=0;n<mt;n++){const{channelTop:L,channelBottom:we,analyzerBottom:ee}=H[n],Xe=this._gradients[this._selectedGrads[n]],Ce=Xe.colorStops,Re=Ce.length,Ne=!me||o&&!K?"#000":Xe.bgColor,ke=xe&&E&&n?-1:1,Te=!n&&z==-1||n&&z==1,st=!N||n&&z!=1?0:ve>>(n||!Te),Ue=N&&Te?-1:1,at=()=>{const c=S.height,_=c>>1,m=k?100:g,G=k?0:Y,$=k?20:5,he=X/(m-G),be=z!=-1&&(!N||n==0||z==1),Ae=z!=1&&(!N||n!=z);t.save(),t.fillStyle=Tt,t.font=`${_}px ${Ke}`,t.textAlign="right",t.lineWidth=1;for(let Ee=m;Ee>G;Ee-=$){const ze=L+(m-Ee)*he,Z=Ee%2==0|0;if(Z){const le=ze+_*(ze==L?.8:.35);be&&t.fillText(Ee,c*.85,le),Ae&&t.fillText(Ee,(N?ve:w.width)-c*.1,le),t.strokeStyle=Tt,t.setLineDash([2,4]),t.lineDashOffset=0}else t.strokeStyle=ei,t.setLineDash([2,8]),t.lineDashOffset=1;t.beginPath(),t.moveTo(v+c*Z*be,~~ze+.5),t.lineTo(Je-c*Z*Ae,~~ze+.5),t.stroke()}t.restore()},Ye=(c,_)=>{const m=pe[c]+(c<pe.length-1?(pe[c+1]-pe[c])*_:0);return isNaN(m)?-1/0:m},Me=(c,_=Ue)=>_*Ie*((c+st)/w.width)+this._spinAngle,ce=(c,_,m)=>{const G=D+_*ke,$=Me(c,m);return[U+G*Math.cos($),C+G*Math.sin($)]},nt=(c,_,m,G,$)=>{t.beginPath();for(const he of z&&!N?[1,-1]:[Ue]){const[be,Ae]=f?[Me(c,he),Me(c+m,he)]:[];t.moveTo(...ce(c,_,he)),t.lineTo(...ce(c,_+G,he)),f?t.arc(U,C,D+(_+G)*ke,be,Ae,he!=1):t.lineTo(...ce(c+m,_+G,he)),t.lineTo(...ce(c+m,_,he)),f&&!$&&t.arc(U,C,D+_*ke,Ae,be,he==1)}it($),t.fill()},rt=(c=0,_=0)=>{let m;if(d==Ze&&!Fe||oe==He)m=Q[n];else{const G=d==wt?_%Re:Ce.findLastIndex($=>o?Be(c)<=Be($.level):c<=$.level);m=Ce[G].color}t.fillStyle=t.strokeStyle=m};if(O){if(N&&!E){const c=ve*(n+Te),_=Te?-1:1;t.setTransform(_,0,0,1,c,0)}if((!K||me)&&(K&&(t.globalAlpha=this.bgAlpha),t.fillStyle=Ne,(n==0||!E&&!W)&&t.fillRect(v,L-se,ve,(K&&this.reflexAlpha==1?X:A)+se),t.globalAlpha=1),this.showScaleY&&!u&&!E&&(n==0||!W)&&at(),o?(t.setLineDash([et,Pe]),t.lineWidth=J[0].width):t.lineWidth=p?Math.min(y,J[0].width/2):y,t.save(),!E){const c=new Path2D;c.rect(0,L,w.width,X),t.clip(c)}}let pe=this._fftData[n];this._analyzer[n].getFloatFrequencyData(pe),b&&(pe=pe.map((c,_)=>c+qt(this._binToFreq(_)))),t.beginPath();let qe=[];for(let c=0;c<_t;c++){const _=J[c],{posX:m,barCenter:G,width:$,freq:he,binLo:be,binHi:Ae,ratioLo:Ee,ratioHi:ze}=_;let Z=Math.max(Ye(be,Ee),Ye(Ae,ze));for(let I=be+1;I<Ae;I++)pe[I]>Z&&(Z=pe[I]);if(Z=this._normalizedB(Z),_.value[n]=Z,ft+=Z,_.peak[n]>0&&_.alpha[n]>0&&(_.hold[n]--,_.hold[n]<0)){if(ne&&!Ge){const I=!h||p&&y>0?1:h?_.peak[n]:te;_.alpha[n]=I*(1+_.hold[n]/re)}else _.peak[n]+=_.hold[n]*ie/V/Dt;_.alpha[n]<=0&&(_.peak[n]=0)}if(Z>=_.peak[n]&&(_.peak[n]=Z,_.hold[n]=M,_.alpha[n]=!h||p&&y>0?1:h?Z:te),!O)continue;t.globalAlpha=u||h?Z:p?te:1,rt(Z,c);const le=u?Se:o?Be(Z):Z*Se|0;if(oe==He){const I=c?0:(this._normalizedB(pe[J[1].binLo])*Se+le)/2;if(E){if(c==0&&(N&&t.moveTo(...ce(0,0)),t.lineTo(...ce(0,m<0?I:le))),m>=0){const ue=[m,le];t.lineTo(...ce(...ue)),qe.push(ue)}}else{if(c==0)if(z==-1&&!N)t.moveTo(v,ee-(m<v?I:le));else{const ue=be?this._normalizedB(pe[be-1])*Se:le;t.moveTo(v-y,ee-ue)}(N||z!=-1||m>=v)&&t.lineTo(m,ee-le)}}else if(o){if(me&&!K&&(n==0||!W)){const I=t.globalAlpha;t.strokeStyle=$t,t.globalAlpha=1,tt(G,L,ee),t.strokeStyle=t.fillStyle,t.globalAlpha=I}if(Fe){const I=u?0:Ce.findLastIndex(je=>Be(Z)<=Be(je.level));let ue=ee;for(let je=Re-1;je>=I;je--){t.strokeStyle=Ce[je].color;let pt=ee-(je==I?le:Be(Ce[je].level));tt(G,ue,pt),ue=pt-Pe}}else tt(G,ee,ee-le)}else if(m>=v)if(E)nt(m,0,$,le,p);else if(f){const I=$/2,ue=ee+I;t.beginPath(),t.moveTo(m,ue),t.lineTo(m,ue-le),t.arc(G,ue-le,I,ut,Ie),t.lineTo(m+$,ue),it(p),t.fill()}else{const I=p?t.lineWidth:0;t.beginPath(),t.rect(m,ee+I,$,-le-I),it(p),t.fill()}const Oe=_.peak[n],gt=_.alpha[n];if(Oe>0&&gt>0&&T&&!Ge&&!u&&m>=v&&m<Je){if(ne?t.globalAlpha=gt:p&&y>0?t.globalAlpha=1:h&&(t.globalAlpha=Oe),(d==bt||Fe)&&rt(Oe),o){const I=Be(Oe);I>=Pe&&t.fillRect(m,ee-I,$,et)}else if(!E)t.fillRect(m,ee-Oe*Se,$,2);else if(oe!=He){const I=Oe*Se;nt(m,I,$,!this._radialInvert||xe||I+D>=2?-2:2)}}}if(O){if(t.globalAlpha=1,oe==He){if(rt(),E&&!N){if(z){let c;for(;c=qe.pop();)t.lineTo(...ce(...c,-1))}t.closePath()}if(y>0&&t.stroke(),te>0){if(E){const c=N?Me(ve>>1):0,_=N?Me(ve):Ie;t.moveTo(...ce(N?ve>>1:0,0)),t.arc(U,C,D,c,_,N?!Te:!0)}else t.lineTo(Je,ee),t.lineTo(v,ee);t.globalAlpha=te,t.fill(),t.globalAlpha=1}if((Ge||E&&T)&&(qe=[],t.beginPath(),J.forEach((c,_)=>{let m=c.posX,G=c.peak[n],$=_?"lineTo":"moveTo";if(E&&m<0){const he=J[_+1];G=ci(m,G,he.posX,he.peak[n],0),m=0}G*=Se,Ge?(t[$](...E?ce(m,G):[m,ee-G]),E&&z&&!N&&qe.push([m,G])):G>0&&nt(m,G,1,-2)}),Ge)){let c;for(;c=qe.pop();)t.lineTo(...ce(...c,-1));t.lineWidth=1,t.stroke()}}t.restore(),N&&!E&&t.setTransform(1,0,0,1,0,0),(!N&&!W||n)&&Gt(n)}}if(Vt(ft/(_t<<mt-1)),O&&(z&&!E&&!N&&(t.setTransform(-1,0,0,1,w.width-v,0),t.drawImage(w,v,0,U,w.height,0,0,U,w.height),t.setTransform(1,0,0,1,0,0)),t.setLineDash([]),Pt()),this.showFPS){const n=S.height;t.font=`bold ${n}px ${Ke}`,t.fillStyle=Yt,t.textAlign="right",t.fillText(Math.round(j),w.width-n,n*2)}this.onCanvasDraw&&(t.save(),t.fillStyle=t.strokeStyle=Q[0],this.onCanvasDraw(this,{timestamp:e,canvasGradients:Q}),t.restore())}_freqScaling(e){switch(this._frequencyScale){case De:return Math.log2(e);case ht:return 26.81*e/(1960+e)-.53;case ct:return Math.log2(1+e/700);case Ve:return e}}_freqToBin(e,i="round"){const a=this._analyzer[0].frequencyBinCount-1,r=Math[i](e*this.fftSize/this.audioCtx.sampleRate);return r<a?r:a}_makeGrad(){if(!this._ready)return;const{canvas:e,_ctx:i,_radial:a,_reflexRatio:r}=this,{analyzerWidth:h,centerX:l,centerY:o,initialX:u,innerRadius:R,outerRadius:p}=this._aux,{isLumi:f}=this._flg,B=this._chLayout==Le,X=1-r,U=f?e.height:e.height*(1-r*!B)|0;for(const C of[0,1]){const H=this._gradients[this._selectedGrads[C]],A=H.colorStops,se=H.dir=="h";let v;if(a?v=i.createRadialGradient(l,o,p,l,o,R-(p-R)*B):v=i.createLinearGradient(...se?[u,0,u+h,0]:[0,0,0,U]),A){const D=B&&!this._splitGradient&&(!se||a);for(let ae=0;ae<1+D;ae++){const J=A.length-1;A.forEach((w,Q)=>{let P=w.pos;if(D&&(P/=2),B&&!f&&!a&&!se&&(P*=X,!D&&P>.5*X&&(P+=.5*r)),ae==1)if(a||f){const d=J-Q;w=A[d],P=1-w.pos/2}else Q==0&&P>0&&v.addColorStop(.5,w.color),P+=.5;v.addColorStop(P,w.color),B&&Q==J&&P<.5&&v.addColorStop(.5,w.color)})}}this._canvasGradients[C]=v}}_normalizedB(e){const i=this._linearAmplitude,a=i?1/this._linearBoost:1,r=(u,R,p)=>u<=R?R:u>=p?p:u,h=u=>10**(u/20);let l=this.maxDecibels,o=this.minDecibels;return i&&(l=h(l),o=h(o),e=h(e)**a),r((e-o)/(l-o)**a,0,1)}_setCanvas(e){if(!this._ready)return;const{canvas:i,_ctx:a}=this,r=this._scaleX.canvas,h=window.devicePixelRatio/(this._loRes+1);let l=window.screen.width*h,o=window.screen.height*h;Math.abs(window.orientation)==90&&l<o&&([l,o]=[o,l]);const u=this.isFullscreen,R=u&&this._fsEl==i,p=R?l:(this._width||this._container.clientWidth||this._defaultWidth)*h|0,f=R?o:(this._height||this._container.clientHeight||this._defaultHeight)*h|0;this._pixelRatio=h,this._fsWidth=l,this._fsHeight=o,!(e!=Bt&&i.width==p&&i.height==f)&&(i.width=p,i.height=f,this.overlay||(a.fillStyle="#000",a.fillRect(0,0,p,f)),a.lineJoin="bevel",r.width=p,r.height=Math.max(20*h,Math.min(p,f)/32|0),this._calcBars(),this._makeGrad(),this._fsStatus!==void 0&&this._fsStatus!==u&&(e=Nt),this._fsStatus=u,this.onCanvasResize&&this.onCanvasResize(e,this))}_setGradient(e,i){if(!this._gradients.hasOwnProperty(e))throw new _e(si,e);[0,1].includes(i)||(this._selectedGrads[1]=e,i=0),this._selectedGrads[i]=e,this._makeGrad()}_setProps(e,i){const a=["onCanvasDraw","onCanvasResize"],r=["gradientLeft","gradientRight","stereo"],h=Object.keys(We).filter(l=>l!="start").concat(a,r);(i||e===void 0)&&(e={...We,...e});for(const l of Object.keys(e))a.includes(l)&&typeof e[l]!="function"?this[l]=void 0:h.includes(l)&&(this[l]=e[l]);e.start!==void 0&&this.toggleAnalyzer(e.start)}}const ui="/assets/astronauta-lt6HAHDX.webp",fi="/assets/valentineKotori-IHLVnYCH.mp3",_i="/assets/aikaimage2-BxF0K5wX.webp",mi="/assets/AikaKotoriStarscream-BI4Qg6th.mp3",gi="/assets/kotori-DYATbuqD.webp",pi="/assets/kotori-BaBDKNXs.mp3",de=[{songName:"Starscream",artist:"Kotori & Aika",duration:"4:08",date:"2018",type:"Dubstep",color:"#ffcd6fa8",copyRight:"Libre",downloadUrl:"/music/AikaKotoriStarscream.mp3",image:_i,song:mi},{songName:"VALENTINE & 4AM",artist:"Kotori (Remix)",duration:"4:07",date:"2017",type:"Dubstep",color:"#0059ff67",downloadUrl:"/music/valentineKotori.mp3",copyRight:"Libre",image:ui,song:fi},{songName:"Kudere",artist:"Kotori",duration:"3:25",date:"2017",type:"Dubstep",color:"#d606ff59",copyRight:"Libre",downloadUrl:"/music/kotori.mp3",image:gi,song:pi}],xi="/assets/logotrazo-Blf9XuOA.webp",vi=()=>s.jsx("article",{className:"modal-visualizer-container",children:s.jsx("p",{style:{fontSize:".8em"},children:"Esta sección es un sueño hecho realidad. Desde hace mucho tiempo quería juntar dos cosas que significan mucho para mí: la música electrónica y la programación. Ambas me han marcado y ahora, poder unirlas en un solo proyecto es algo que simplemente me llena de felicidad. No es solo una función más en la página, es una parte de mí, algo que siempre quise compartir. Espero que la disfrutes tanto como yo disfruté crearla."})}),wi=({uploadSong:x,musicData:e,songIndex:i})=>s.jsxs("div",{children:[s.jsx("ul",{children:s.jsxs("li",{children:[s.jsx("span",{children:s.jsxs("svg",{stroke:"currentColor",fill:"white",strokeWidth:"0",viewBox:"0 0 24 24",height:"1em",width:"1em",children:[s.jsx("path",{fill:"none",d:"M0 0h24v24H0z"}),s.jsx("path",{d:"M18.41 5.8 17.2 4.59c-.78-.78-2.05-.78-2.83 0l-2.68 2.68L3 15.96V20h4.04l8.74-8.74 2.63-2.63c.79-.78.79-2.05 0-2.83zM6.21 18H5v-1.21l8.66-8.66 1.21 1.21L6.21 18zM11 20l4-4h6v4H11z"})]})}),"Nombre:",s.jsx("span",{children:x?x.name:e[i].songName})]})}),s.jsx("ul",{children:s.jsxs("li",{children:[s.jsx("span",{children:s.jsx("svg",{stroke:"currentColor",fill:"white",strokeWidth:"0",viewBox:"0 0 448 512",height:"1em",width:"1em",children:s.jsx("path",{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"})})}),"Artista:",s.jsx("span",{children:x?"?":e[i].artist})]})}),s.jsx("ul",{children:s.jsxs("li",{children:[s.jsx("span",{children:s.jsxs("svg",{stroke:"currentColor",fill:"white",strokeWidth:"0",viewBox:"0 0 24 24",height:"1em",width:"1em",children:[s.jsx("path",{fill:"none",d:"M0 0h24v24H0z"}),s.jsx("path",{d:"M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"})]})}),"Lanzamiento:",s.jsx("span",{children:x?"?":e[i].date})]})}),s.jsx("ul",{children:s.jsxs("li",{children:[s.jsx("span",{children:s.jsx("svg",{stroke:"currentColor",fill:"white",strokeWidth:"0",viewBox:"0 0 512 512",height:"1em",width:"1em",children:s.jsx("path",{d:"M256 0a256 256 0 1 1 0 512A256 256 0 1 1 256 0zM232 120l0 136c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2 280 120c0-13.3-10.7-24-24-24s-24 10.7-24 24z"})})}),"Duración:",s.jsx("span",{children:x?"?":e[i].duration}),"min"]})}),s.jsx("ul",{children:s.jsxs("li",{children:[s.jsx("span",{children:s.jsx("svg",{stroke:"currentColor",fill:"white",strokeWidth:"0",viewBox:"0 0 512 512",height:"1em",width:"1em",children:s.jsx("path",{d:"M256 48a208 208 0 1 1 0 416 208 208 0 1 1 0-416zm0 464A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM199.4 312.6c-31.2-31.2-31.2-81.9 0-113.1s81.9-31.2 113.1 0c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9c-50-50-131-50-181 0s-50 131 0 181s131 50 181 0c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0c-31.2 31.2-81.9 31.2-113.1 0z"})})}),"CopyRight:",s.jsx("span",{children:x?"?":e[i].copyRight})]})})]}),bi=()=>[{play:s.jsx("svg",{stroke:"currentColor",fill:"white",strokeWidth:"0",viewBox:"0 0 448 512",height:"1em",width:"1em",children:s.jsx("path",{d:"M424.4 214.7L72.4 6.6C43.8-10.3 0 6.1 0 47.9V464c0 37.5 40.7 60.1 72.4 41.3l352-208c31.4-18.5 31.5-64.1 0-82.6z"})})},{pause:s.jsx("svg",{stroke:"currentColor",fill:"white",strokeWidth:"0",viewBox:"0 0 320 512",height:"1em",width:"1em",children:s.jsx("path",{d:"M48 64C21.5 64 0 85.5 0 112L0 400c0 26.5 21.5 48 48 48l32 0c26.5 0 48-21.5 48-48l0-288c0-26.5-21.5-48-48-48L48 64zm192 0c-26.5 0-48 21.5-48 48l0 288c0 26.5 21.5 48 48 48l32 0c26.5 0 48-21.5 48-48l0-288c0-26.5-21.5-48-48-48l-32 0z"})})},{next:s.jsx("svg",{stroke:"currentColor",fill:"white",strokeWidth:"0",viewBox:"0 0 512 512",height:"1em",width:"1em",children:s.jsx("path",{d:"m16 400 240-144L16 112v288zm240 0 240-144-240-144v288z"})})},{prev:s.jsx("svg",{stroke:"currentColor",fill:"white",strokeWidth:"0",viewBox:"0 0 512 512",height:"1em",width:"1em",children:s.jsx("path",{d:"M496 400 256 256l240-144v288zm-240 0L16 256l240-144v288z"})})},{volOff:s.jsxs("svg",{stroke:"currentColor",fill:"white",strokeWidth:"0",viewBox:"0 0 512 512",height:"1.3em",width:"1.3em",children:[s.jsx("path",{d:"M405.5 256c0 22.717-4.883 44.362-13.603 63.855l31.88 31.88C439.283 323.33 448 290.653 448 256c0-93.256-64-172.254-149-192v44.978C361 127.632 405.5 186.882 405.5 256zM256 80.458l-51.021 52.48L256 183.957zM420.842 396.885L91.116 67.157l-24 24 90.499 90.413-8.28 10.43H64v128h85.334L256 431.543V280l94.915 94.686C335.795 387.443 318 397.213 299 403.022V448c31-7.172 58.996-22.163 82.315-42.809l39.61 39.693 24-24.043-24.002-24.039-.081.083z"}),s.jsx("path",{d:"M352.188 256c0-38.399-21.188-72.407-53.188-88.863v59.82l50.801 50.801A100.596 100.596 0 0 0 352.188 256z"})]})},{down:s.jsx("svg",{stroke:"currentColor",fill:"white",strokeWidth:"0",viewBox:"0 0 448 512",height:"1em",width:"1em",children:s.jsx("path",{d:"M413.1 222.5l22.2 22.2c9.4 9.4 9.4 24.6 0 33.9L241 473c-9.4 9.4-24.6 9.4-33.9 0L12.7 278.6c-9.4-9.4-9.4-24.6 0-33.9l22.2-22.2c9.5-9.5 25-9.3 34.3.4L184 343.4V56c0-13.3 10.7-24 24-24h32c13.3 0 24 10.7 24 24v287.4l114.8-120.5c9.3-9.8 24.8-10 34.3-.4z"})})},{volOn:s.jsx("svg",{stroke:"currentColor",fill:"white",strokeWidth:"0",viewBox:"0 0 576 512",height:"1.3em",width:"1.3em",children:s.jsx("path",{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zm233.32-51.08c-11.17-7.33-26.18-4.24-33.51 6.95-7.34 11.17-4.22 26.18 6.95 33.51 66.27 43.49 105.82 116.6 105.82 195.58 0 78.98-39.55 152.09-105.82 195.58-11.17 7.32-14.29 22.34-6.95 33.5 7.04 10.71 21.93 14.56 33.51 6.95C528.27 439.58 576 351.33 576 256S528.27 72.43 448.35 19.97zM480 256c0-63.53-32.06-121.94-85.77-156.24-11.19-7.14-26.03-3.82-33.12 7.46s-3.78 26.21 7.41 33.36C408.27 165.97 432 209.11 432 256s-23.73 90.03-63.48 115.42c-11.19 7.14-14.5 22.07-7.41 33.36 6.51 10.36 21.12 15.14 33.12 7.46C447.94 377.94 480 319.54 480 256zm-141.77-76.87c-11.58-6.33-26.19-2.16-32.61 9.45-6.39 11.61-2.16 26.2 9.45 32.61C327.98 228.28 336 241.63 336 256c0 14.38-8.02 27.72-20.92 34.81-11.61 6.41-15.84 21-9.45 32.61 6.43 11.66 21.05 15.8 32.61 9.45 28.23-15.55 45.77-45 45.77-76.88s-17.54-61.32-45.78-76.86z"})})},{delete:s.jsx("svg",{stroke:"currentColor",fill:"red",strokeWidth:"0",viewBox:"0 0 24 24",height:"1em",width:"1em",children:s.jsx("path",{d:"M7 4V2H17V4H22V6H20V21C20 21.5523 19.5523 22 19 22H5C4.44772 22 4 21.5523 4 21V6H2V4H7ZM6 6V20H18V6H6ZM9 9H11V17H9V9ZM13 9H15V17H13V9Z"})})},{upload:s.jsxs("svg",{stroke:"currentColor",fill:"green",strokeWidth:"0",viewBox:"0 0 24 24",height:"1em",width:"1em",children:[s.jsx("path",{fill:"none",d:"M0 0h24v24H0z"}),s.jsx("path",{d:"M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z"})]})},{info:s.jsxs("svg",{stroke:"currentColor",fill:"white",strokeWidth:"0",viewBox:"0 0 512 512",height:"1.2em",width:"1.2em",children:[s.jsx("path",{d:"M235.4 172.2c0-11.4 9.3-19.9 20.5-19.9 11.4 0 20.7 8.5 20.7 19.9s-9.3 20-20.7 20c-11.2 0-20.5-8.6-20.5-20zm1.4 35.7H275V352h-38.2V207.9z"}),s.jsx("path",{d:"M256 76c48.1 0 93.3 18.7 127.3 52.7S436 207.9 436 256s-18.7 93.3-52.7 127.3S304.1 436 256 436c-48.1 0-93.3-18.7-127.3-52.7S76 304.1 76 256s18.7-93.3 52.7-127.3S207.9 76 256 76m0-28C141.1 48 48 141.1 48 256s93.1 208 208 208 208-93.1 208-208S370.9 48 256 48z"})]})},{headPhones:s.jsx("svg",{stroke:"currentColor",fill:"white",strokeWidth:"0",viewBox:"0 0 512 512",height:"1em",width:"1em",children:s.jsx("path",{d:"M256 80C149.9 80 62.4 159.4 49.6 262c9.4-3.8 19.6-6 30.4-6c26.5 0 48 21.5 48 48l0 128c0 26.5-21.5 48-48 48c-44.2 0-80-35.8-80-80l0-16 0-48 0-48C0 146.6 114.6 32 256 32s256 114.6 256 256l0 48 0 48 0 16c0 44.2-35.8 80-80 80c-26.5 0-48-21.5-48-48l0-128c0-26.5 21.5-48 48-48c10.8 0 21 2.1 30.4 6C449.6 159.4 362.1 80 256 80z"})})}],Li=({energy:x,musicData:e,songIndex:i})=>{const a=Math.min(Math.max(x,0),1);return s.jsx("span",{className:"orb",style:{boxShadow:`0px 0px ${a*80}px ${e[i].color}`,background:`linear-gradient(to right, ${e[i].color}, rgba(255, 0, 179, 0.5))`,opacity:a*.7,transform:`scale(${1+a*.5})`}})},Si=()=>{const x=bi(),e=fe.useRef(null),i=fe.useRef(null),a=fe.useRef(null),r=fe.useRef(null),[h,l]=fe.useState(0),[o,u]=fe.useState(0),[R,p]=fe.useState(1),[f,B]=fe.useState(null),[X,U]=fe.useState(0),[C,H]=fe.useState({isPlaying:!1,isMute:!1,aboutSection:!1,volumeMode:!1}),A=d=>{H(t=>({...t,[d]:!t[d]}))},se=()=>{if(!C.volumeMode)return;const d=a.current;if(!d)return;const{top:t,bottom:F,height:ne}=d.getBoundingClientRect(),te=window.innerHeight,j=Math.min(F,te)-Math.max(t,0),k=Math.max(0,Math.min(1,j/ne)),y=Math.max(.01,k);i.current&&(i.current.volume=y)};fe.useEffect(()=>{const d=()=>{se()};return C.volumeMode&&(window.addEventListener("scroll",d),window.addEventListener("resize",d)),()=>{window.removeEventListener("scroll",d),window.removeEventListener("resize",d)}},[C.volumeMode]),fe.useEffect(()=>{const d=new Audio(f?URL.createObjectURL(f):de[h].song);i.current=d;const t=new di(e.current,{source:d,height:250,width:700,gradient:"rainbow",showScaleY:!0,frequencyScale:"log",bgAlpha:3,ledBars:!0,showBgColor:!1,roundBars:!0,mode:6,reflexRatio:0,fillAlpha:0,lineWidth:1,linearAmplitude:!1,alphaBars:!1,showScaleX:!1,showPeaks:!1}),F=()=>{const te=t.getEnergy("bass");u(te),requestAnimationFrame(F)};F(),r.current=t;const ne=()=>{console.log("El audio ha terminado de reproducirse"),ae("next"),U(0)};return d.addEventListener("ended",ne),()=>{r.current&&r.current.destroy(),d.removeEventListener("ended",ne)}},[h,f]);const v=()=>{C.isPlaying?C.isPlaying&&(i.current.pause(),A("isPlaying")):(A("isPlaying"),i.current.play().then().catch(d=>{console.log("Error al reproducir el audio:",d)}))},D=d=>{if(!C.volumeMode){const t=parseFloat(d.target.value);p(t),H(F=>({...F,isMute:!1})),i.current&&(i.current.volume=t)}},ae=d=>{d=="next"?(l(t=>(t+1)%de.length),H(t=>({...t,isPlaying:!1})),U(0)):d=="prev"&&(l(t=>(t-1+de.length)%de.length),U(0),H(t=>({...t,isPlaying:!1})))},J=d=>{d=="mute"&&i.current&&!C.volumeMode?(i.current.volume=0,A("isMute")):d=="unmute"&&(i.current.volume=R,A("isMute"))},w=d=>{const t=d.target.files[0];B(t),H(F=>({...F,isPlaying:!1})),U(0)},Q=()=>{f&&(B(null),URL.revokeObjectURL(f),H(d=>({...d,isPlaying:!1})),U(0))},P=d=>{const t=d.target.value;U(t),i.current&&(i.current.currentTime=t)};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"dubstep-title-container",children:[s.jsx("div",{children:s.jsx("h2",{className:"dubstep-zone-title h-title ",children:"Dubstep zone"})}),s.jsxs("div",{className:"wrapper",children:[s.jsx("p",{children:"Música"}),s.jsxs("div",{className:"words",children:[s.jsx("span",{className:"w-span",children:"libre"}),s.jsx("span",{className:"w-span",children:"sin copyright"}),s.jsx("span",{className:"w-span",children:"free"})]})]})]}),s.jsxs("section",{ref:a,className:"audio-container",children:[s.jsxs("div",{className:"music-controls",children:[s.jsx(Li,{energy:o,musicData:de,songIndex:h}),s.jsxs("div",{className:"m-control-separator",children:[s.jsxs("div",{className:"m-title",children:[s.jsxs("h3",{style:{fontSize:"1.7em"},children:[f?f.name:de[h].songName," "]}),s.jsx("span",{children:f?"Desconocido":de[h].artist})]}),s.jsxs("span",{className:"music-counter ",children:[h+1,"/",de.length]})]}),f?s.jsx("img",{src:xi,style:{boxShadow:`0px 0px ${o*40}px #0059ff67 `}}):s.jsx("img",{src:de[h].image,alt:"Skrillex",style:{boxShadow:`0px 0px ${o*40}px ${de[h].color} `}})]}),s.jsx("div",{className:"music-visualizer",ref:e}),s.jsxs("div",{className:"music-info",children:[s.jsx("div",{className:"m-i-volume-section",children:s.jsxs("div",{className:"m-i-volumeBar-container",children:[s.jsxs("div",{children:[s.jsxs("h3",{children:["Controles",s.jsxs("span",{className:"headphones",children:[x[10].headPhones," Mejor experiencia"]})]}),s.jsxs("div",{className:"b-controls-container",children:[s.jsx("button",{"aria-label":"PrevSong",className:"m-button",onClick:()=>ae("prev"),children:x[3].prev}),s.jsx("button",{"aria-label":"PlaySong",className:"m-button",onClick:v,children:C.isPlaying?x[1].pause:x[0].play}),s.jsx("button",{"aria-label":"NextSong",className:"m-button",onClick:()=>ae("next"),children:x[2].next})]})]}),s.jsxs("div",{children:[s.jsxs("div",{children:[s.jsxs("span",{className:"m-button",children:[R*10,"% "]}),s.jsx("label",{className:"slider",children:s.jsx("input",{"aria-label":"volRange",type:"range",step:"0.1",min:0,max:1,onChange:D,className:"level"})}),s.jsx("button",{"aria-label":"MuteSong",onClick:()=>J(C.isMute?"unmute":"mute"),className:"m-button",children:C.isMute?x[4].volOff:x[6].volOn})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"tooltip-container",children:[s.jsx("a",{"aria-label":"DowloadCurrentSong",className:"m-button",href:de[h].downloadUrl,download:`${de[h].songName}.mp3`,children:x[5].down}),s.jsx("span",{className:"tooltip",children:"Descargar"})]}),s.jsxs("div",{className:"tooltip-container",children:[s.jsx("button",{"aria-label":"VolSong",className:"m-button volume-mode ",onClick:()=>A("volumeMode"),children:C.volumeMode?"Scroll":"Manual"}),s.jsx("span",{className:"tooltip",children:"Volumen"})]})]})]}),s.jsx("div",{children:s.jsx("input",{"aria-label":"DurationSong",style:{width:"100%",cursor:"pointer"},className:"duration-input",type:"range",step:"1",value:i.current?i.current.currentTime:0,max:i.current&&!isNaN(i.current.duration)?i.current.duration:0,onChange:P})})]})}),s.jsxs("div",{className:"music-info-section",children:[s.jsx("h3",{children:"Información de la pista"}),s.jsx(wi,{uploadSong:f,musicData:de,songIndex:h}),s.jsxs("div",{className:"upload-music-container",children:[s.jsxs("div",{className:"upload-music-title",children:[s.jsx("h3",{children:"Sube tu música"}),s.jsx("button",{type:"button",className:"m-button","aria-label":"aboutSection",onClick:()=>A("aboutSection"),children:x[9].info})]}),C.aboutSection?s.jsx(vi,{}):s.jsxs("div",{children:[s.jsx("p",{children:"Sube tu canción favorita y disfruta del visualizador al ritmo perfecto"}),s.jsx("p",{children:"FORMATOS SOPORTADOS"}),s.jsx("p",{children:"MP3, M4a"}),s.jsxs("div",{className:"flex-separator",children:[s.jsx("input",{style:{display:"none"},type:"file",id:"file-upload",accept:"audio/*",onChange:w}),s.jsxs("label",{className:"m-button label-upload",htmlFor:"file-upload",children:["Subir ",x[8].upload]}),s.jsxs("button",{"aria-label":"DeleteSong",className:"m-button delete-upload",onClick:Q,children:["Eliminar ",x[7].delete]})]}),s.jsx("div",{className:"upload-status",children:s.jsx("p",{className:f?"uploadtrue":"uploadfalse",children:f?"CANCiÓN PERSONALIZADA LISTA PARA REPRODUCIR":"NO SE HA CARGADO NINGUNA CANCIÓN"})})]})]})]})]})]})]})};export{Si as default};
